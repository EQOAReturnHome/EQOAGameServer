using System;
using System.Collections.Generic;

namespace ReturnHome.Server.EntityObject.Player
{
    public class TrainingPoints
    {
        public int TotalTrainingPoints { get; private set; }

        private int _spentTrainingPoints;
        public int RemainingTrainingPoints => TotalTrainingPoints - _spentTrainingPoints;

        //Earnable TP's were 462 + 20 starting TP's
        private static int _maxTrainingPoints = 482;
        private bool _hitMaxTrainingPoints;

        //Allows us to reset Spent Training Points, method calling this needs to ensure stats are reset
        public void ResetTrainingPoints() => _spentTrainingPoints = 0;

        public TrainingPoints(int totalTrainingPoints, int UnusedTrainingPoints)
        {
            if (TotalTrainingPoints > _maxTrainingPoints)
                Console.WriteLine("Error, character has more then max allowable Training Points");

            if (TotalTrainingPoints == _maxTrainingPoints)
                _hitMaxTrainingPoints = true;

            else
                _hitMaxTrainingPoints = false;
            TotalTrainingPoints = totalTrainingPoints;
            _spentTrainingPoints = TotalTrainingPoints - UnusedTrainingPoints;
        }

        //Allows us to add additional Training Points to our specified maximum in _maxTrainingPoints
        public void EarnTrainingPoints(int TotalEarned)
        {
            //If we have already hit max... earn no more, shouldn't technically happen
            if (_hitMaxTrainingPoints)
                return;

            //TODO: Do we need logic to ensure we don't exceed the cap here?
            TotalTrainingPoints += TotalEarned;
        }

        public bool SpendTrainingPoints(int SpentTrainingPoints)
        {
            //Probably should escalate if a Character is negative training points, would be a glitch.
            if (_hitMaxTrainingPoints || RemainingTrainingPoints <= 0 || SpentTrainingPoints == 0)
                return false;

            if (SpentTrainingPoints <= RemainingTrainingPoints)
            {
                _spentTrainingPoints += SpentTrainingPoints;
                return true;
            }

            else
                Console.WriteLine("Character traying to spent more training points then remaining");

            return false;
        }

        //Starts at 21 due to first 20 TP's are free
        public static readonly Dictionary<int, long> TrainingPointDict = new Dictionary<int, long>
        {
            {21, 148}, {22, 283}, {23, 424}, {24, 1189}, {25, 1883}, {26, 2611}, {27, 5053}, {28, 7264}, {29, 9587}, {30, 15581}, {31, 21009},
            {32, 26712}, {33, 39186}, {34, 50484}, {35, 62352}, {36, 85522}, {37, 106507}, {38, 128551}, {39, 168154}, {40, 204023}, {41, 241703},
            {42, 305235}, {43, 362778}, {44, 423224}, {45, 520174}, {46, 607983}, {47, 700224}, {48, 842308}, {49, 970996}, {50, 1106179},
            {51, 1307577}, {52, 1489987}, {53, 1681603}, {54, 1959194}, {55, 2210612}, {56, 2474720}, {57, 2848316}, {58, 3186686}, {59, 3542136},
            {60, 4034717}, {61, 4480855}, {62, 4949511}, {63, 5314055}, {64, 5678599}, {65, 6043143}, {66, 6407687}, {67, 6772231}, {68, 7237001},
            {69, 7701771}, {70, 8166540}, {71, 8631310}, {72, 9096080}, {73, 9680446}, {74, 10264813}, {75, 10849179}, {76, 11433546}, {77, 12017912},
            {78, 12743594}, {79, 13469276}, {80, 14194959}, {81, 14920641}, {82, 15646323}, {83, 16537523}, {84, 17428723}, {85, 18319923},
            {86, 19211123}, {87, 20102323}, {88, 21185860}, {89, 22269397}, {90, 23352934}, {91, 24436471}, {92, 25520008}, {93, 26825453},
            {94, 28130898}, {95, 29436342}, {96, 30741787}, {97, 32047232}, {98, 33607041}, {99, 35166851}, {100, 36726660}, {101, 38286470},
            {102, 39846279}, {103, 41695930}, {104, 43545581}, {105, 45395233}, {106, 47244884}, {107, 49094535}, {108, 51272660}, {109, 53450785},
            {110, 55628910}, {111, 57807035}, {112, 59985160}, {113, 62533680}, {114, 65082200}, {115, 67630720}, {116, 70179240}, {117, 72727760},
            {118, 75692020}, {119, 78656280}, {120, 81620539}, {121, 84584799}, {122, 87549059}, {123, 90977961}, {124, 94406864}, {125, 97835766},
            {126, 101264669}, {127, 104693571}, {128, 108639711}, {129, 112585851}, {130, 116531992}, {131, 120478132}, {132, 124424272}, {133, 128944072},
            {134, 133463872}, {135, 137983672}, {136, 142503472}, {137, 147023272}, {138, 150630962}, {139, 154238652}, {140, 156042497}, {141, 159650187},
            {142, 161350956}, {143, 164211338}, {144, 167071721}, {145, 169932104}, {146, 172792487}, {147, 176889142}, {148, 180985798}, {149, 183034125},
            {150, 187130781}, {151, 189062061}, {152, 192310124}, {153, 195558186}, {154, 198806249}, {155, 202054311}, {156, 206688028}, {157, 211321745},
            {158, 213638603}, {159, 218272320}, {160, 220456786}, {161, 224130662}, {162, 227804537}, {163, 231478413}, {164, 235152288}, {165, 240374217},
            {166, 245596147}, {167, 248207112}, {168, 253429041}, {169, 255890808}, {170, 260031052}, {171, 264171296}, {172, 268311540}, {173, 272451784},
            {174, 278316226}, {175, 284180669}, {176, 287112890}, {177, 292977333}, {178, 295741998}, {179, 300391664}, {180, 305041329}, {181, 309690994},
            {182, 314340659}, {183, 320905158}, {184, 327469657}, {185, 330751907}, {186, 337316406}, {187, 340411099}, {188, 345615809}, {189, 350820519},
            {190, 356025229}, {191, 361229939}, {192, 368555376}, {193, 375880813}, {194, 379543531}, {195, 386868968}, {196, 390322388}, {197, 396130413},
            {198, 401938438}, {199, 407746463}, {200, 413554488}, {201, 421705175}, {202, 429855862}, {203, 433931205}, {204, 442081892}, {205, 445924359},
            {206, 452386689}, {207, 458849019}, {208, 465311350}, {209, 471773680}, {210, 480817455}, {211, 489861229}, {212, 494383117}, {213, 503426892},
            {214, 507690385}, {215, 514860807}, {216, 522031228}, {217, 529201650}, {218, 536372071}, {219, 546380391}, {220, 556388711}, {221, 561392871},
            {222, 571401191}, {223, 576119399}, {224, 584054567}, {225, 591989735}, {226, 599924903}, {227, 607860071}, {228, 618908107}, {229, 629956144},
            {230, 635480162}, {231, 646528198}, {232, 651736558}, {233, 660496073}, {234, 669255587}, {235, 678015102}, {236, 686774616}, {237, 698941347},
            {238, 711108079}, {239, 717191444}, {240, 729358176}, {241, 735093921}, {242, 744740400}, {243, 754386880}, {244, 764033360}, {245, 773679840},
            {246, 787048147}, {247, 800416454}, {248, 807100607}, {249, 820468914}, {250, 826771116}, {251, 837370274}, {252, 847969432}, {253, 858568589},
            {254, 869167747}, {255, 883824506}, {256, 898481265}, {257, 905809645}, {258, 920466404}, {259, 927376019}, {260, 938996735}, {261, 950617451},
            {262, 962238167}, {263, 973858883}, {264, 989895061}, {265, 1005931238}, {266, 1013949327}, {267, 1029985504}, {268, 1037545416}, {269, 1050259814},
            {270, 1062974212}, {271, 1075688610}, {272, 1088403008}, {273, 1102161452}, {274, 1106288985}, {275, 1115919895}, {276, 1124174961},
            {277, 1137182944}, {278, 1142060938}, {279, 1150941388}, {280, 1162198296}, {281, 1168827365}, {282, 1184712113}, {283, 1186713341},
            {284, 1198470557}, {285, 1204599318}, {286, 1213479768}, {287, 1228474924}, {288, 1232973471}, {289, 1243470080}, {290, 1252467173},
            {291, 1266644412}, {292, 1271960876}, {293, 1281639568}, {294, 1293908331}, {295, 1301133270}, {296, 1318445859}, {297, 1320626973},
            {298, 1333441015}, {299, 1340120675}, {300, 1349799367}, {301, 1366112793}, {302, 1371006821}, {303, 1382426219}, {304, 1392214274},
            {305, 1407637877}, {306, 1413421728}, {307, 1423951303}, {308, 1437298651}, {309, 1445158757}, {310, 1463993348}, {311, 1466366210},
            {312, 1480306774}, {313, 1487573664}, {314, 1498103239}, {315, 1515820002}, {316, 1521135031}, {317, 1533536765}, {318, 1544166823},
            {319, 1560917217}, {320, 1567198614}, {321, 1578633980}, {322, 1593129513}, {323, 1601665771}, {324, 1622120579}, {325, 1624697563},
            {326, 1639837342}, {327, 1647729355}, {328, 1659164720}, {329, 1678373470}, {330, 1684136095}, {331, 1697582220}, {332, 1709107470},
            {333, 1727268470}, {334, 1734078845}, {335, 1746477220}, {336, 1762193470}, {337, 1771448595}, {338, 1793625970}, {339, 1796419970},
            {340, 1812834720}, {341, 1821391345}, {342, 1833789720}, {343, 1854582764}, {344, 1860820678}, {345, 1875375808}, {346, 1887851635},
            {347, 1907510513}, {348, 1914882593}, {349, 1928303558}, {350, 1945316048}, {351, 1955334515}, {352, 1979341030}, {353, 1982365473},
            {354, 2000134074}, {355, 2009396430}, {356, 2022817395}, {357, 2045290772}, {358, 2052032785}, {359, 2067764148}, {360, 2081248174},
            {361, 2102495730}, {362, 2110463564}, {363, 2124969107}, {364, 2143356415}, {365, 2154184497}, {366, 2180131031}, {367, 2183399886},
            {368, 2202604408}, {369, 2212615276}, {370, 2227120819}, {371, 2251374371}, {372, 2258650437}, {373, 2275627923}, {374, 2290180054},
            {375, 2313110685}, {376, 2321709672}, {377, 2337364238}, {378, 2357208053}, {379, 2368893855}, {380, 2396895683}, {381, 2400423473},
            {382, 2421149236}, {383, 2431953091}, {384, 2447607656}, {385, 2473745105}, {386, 2481586340}, {387, 2499882555}, {388, 2515565024},
            {389, 2540276795}, {390, 2549543709}, {391, 2566414244}, {392, 2587799430}, {393, 2600392928}, {394, 2630569802}, {395, 2634371612},
            {396, 2656707251}, {397, 2668350297}, {398, 2685220832}, {399, 2713349853}, {400, 2721788560}, {401, 2741478874}, {402, 2758356287},
            {403, 2784950998}, {404, 2794924015}, {405, 2813080020}, {406, 2836094673}, {407, 2849647747}, {408, 2882123981}, {409, 2886215475},
            {410, 2910253002}, {411, 2922783202}, {412, 2940939207}, {413, 2971171501}, {414, 2980241190}, {415, 3001403796}, {416, 3019543172},
            {417, 3048126433}, {418, 3058845155}, {419, 3078358727}, {420, 3103094241}, {421, 3117660710}, {422, 3152565268}, {423, 3156962692},
            {424, 3182797562}, {425, 3196264675}, {426, 3215778247}, {427, 3248229616}, {428, 3257965027}, {429, 3280680986}, {430, 3300151807},
            {431, 3330833102}, {432, 3342338588}, {433, 3363284472}, {434, 3389835592}, {435, 3405471252}, {436, 3442937833}, {437, 3447658032},
            {438, 3475389202}, {439, 3489844812}, {440, 3510790696}, {441, 3545581117}, {442, 3556018243}, {443, 3580371537}, {444, 3601245790},
            {445, 3634138551}, {446, 3646473337}, {447, 3668928972}, {448, 3697393862}, {449, 3714156519}, {450, 3754323641}, {451, 3759384066},
            {452, 3789114062}, {453, 3804611613}, {454, 3827067248}, {455, 3864320945}, {456, 3875497054}, {457, 3901574642}, {458, 3923926860},
            {459, 3959148537}, {460, 3972356666}, {461, 3996402234}, {462, 4026882531}, {463, 4044832039}, {464, 4087843126}, {465, 4093261845},
            {466, 4125096822}, {467, 4141691651}, {468, 4165737219}, {469, 4205582739}, {470, 4217536395}, {471, 4245428259}, {472, 4269335571},
            {473, 4307007699}, {474, 4321134747}, {475, 4346853219}, {476, 4379454099}, {477, 4398652395}, {478, 4444655859}, {479, 4450451571},
            {480, 4484501379}, {481, 4502250747}, {482, 4527969219}
        };
    }
}
